<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Immersive spaces - Donovan's Vision Blog</title>
		<meta name="description" content="What an immersive space is, and when you might want to use it">
		<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
		<link rel="manifest" href="/site.webmanifest">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Donovan’s Vision Blog">
		<link rel="alternate" href="/feed/feed.json" type="application/json" title="Donovan’s Vision Blog">

		<meta name="fediverse:creator" content="@donovanh@mastodon.ie" />

		<meta property="og:title" content="Immersive spaces" />
		<meta property="og:type" content="article" />
		<meta property="og:description" content="What an immersive space is, and when you might want to use it">
		<meta property="og:url" content="" />
		<meta name="generator" content="Eleventy v2.0.1">
		<style>/**
 * okaidia theme for JavaScript, CSS and HTML
 * Loosely based on Monokai textmate theme by http://www.monokai.nl/
 * @author ocodia
 */

code[class*="language-"],
pre[class*="language-"] {
	color: #f8f8f2;
	background: none;
	text-shadow: 0 1px rgba(0, 0, 0, 0.3);
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
	border-radius: 0.3em;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #272822;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: #8292a2;
}

.token.punctuation {
	color: #f8f8f2;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.constant,
.token.symbol,
.token.deleted {
	color: #f92672;
}

.token.boolean,
.token.number {
	color: #ae81ff;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #a6e22e;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string,
.token.variable {
	color: #f8f8f2;
}

.token.atrule,
.token.attr-value,
.token.function,
.token.class-name {
	color: #e6db74;
}

.token.keyword {
	color: #66d9ef;
}

.token.regex,
.token.important {
	color: #fd971f;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
/*
 * New diff- syntax
 */

pre[class*="language-diff-"] {
	--eleventy-code-padding: 1.25em;
	padding-left: var(--eleventy-code-padding);
	padding-right: var(--eleventy-code-padding);
}
.token.deleted {
	background-color: hsl(0, 51%, 37%);
	color: inherit;
}
.token.inserted {
	background-color: hsl(126, 31%, 39%);
	color: inherit;
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	-webkit-user-select: none;
	user-select: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding-top: 2px;
	padding-bottom: 2px;
}
.token.prefix.inserted,
.token.prefix.deleted {
	width: var(--eleventy-code-padding);
	background-color: rgba(0,0,0,.2);
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	margin-left: calc(-1 * var(--eleventy-code-padding));
	margin-right: calc(-1 * var(--eleventy-code-padding));
	text-decoration: none; /* override del, ins, mark defaults */
	color: inherit; /* override del, ins, mark defaults */
}
* { box-sizing: border-box; }
/* Defaults */
:root {
	--font-family: -apple-system, system-ui, sans-serif;
	--font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono,
		Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono,
		Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New,
		Courier, monospace;
}

/* Theme colors */
:root {
	--color-gray-70: rgba(255, 255, 255, 0.3);
	--color-gray-50: rgba(255, 255, 255, 0.5);
	--color-gray-20: rgba(255, 255, 255, 0.8);

	--background-color: #000;

	--text-color: var(--color-gray-20);
	--text-color-link: rgba(241, 233, 255, 0.8);
	--text-color-link-active: rgba(241, 233, 255, 1);
	--text-color-link-visited: rgba(241, 233, 255, 0.5);

	--syntax-tab-size: 2;
}

/* TODO: Make a proper dark theme? */
/* @media (prefers-color-scheme: dark) {
	:root {
		--color-gray-20: #e0e0e0;
		--color-gray-50: #c0c0c0;
		--color-gray-70: #dad8d8;

		/* --text-color is assigned to --color-gray-_ above 
		--text-color-link: #1493fb;
		--text-color-link-active: #6969f7;
		--text-color-link-visited: #a6a6f8;

		--background-color: #15202b;
	}
} */

/* Global stylesheet */
* {
	box-sizing: border-box;
}

html,
body {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	color: var(--text-color);
	text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
	/* TODO: Have this dynamically change by time of day */
	background: var(--background-color);
	background-image: url("/img/office.webp");
	background-size: 100vw;
	background-repeat: no-repeat;
}
html {
	overflow-y: scroll;
}

.bodyBackground {
	opacity: 0;
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

li {
	line-height: 1.5;
}

a[href] {
	color: var(--text-color-link);
}
a[href]:visited {
	color: var(--text-color-link-visited);
}
a[href]:hover,
a[href]:active {
	color: var(--text-color-link-active);
}

main {
	padding: 1rem 0;
}

.links-nextprev {
	list-style: none;
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}

table {
	margin: 1em 0;
}
table td,
table th {
	padding-right: 1em;
}

pre,
code {
	font-family: var(--font-family-monospace);
	word-break: break-word;
}
pre:where([class*="language-"]) {
	width: 100%;
}
pre:not([class*="language-"]) {
	margin: 0.5em 0;
	line-height: 1.375; /* 22px /16 */
	-moz-tab-size: var(--syntax-tab-size);
	-o-tab-size: var(--syntax-tab-size);
	tab-size: var(--syntax-tab-size);
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
}
code {
	word-break: break-all;
}

.panel {
	background-color: rgba(89, 89, 89, 0.2);
	box-shadow: -0.25px -0.25px 0.25px 0 rgba(255, 255, 255, 0.15),
		0 0 1rem 0 rgba(0, 0, 0, 0.1);
	border-radius: 2.5rem;
	position: relative;
	backdrop-filter: blur(20px);
	-webkit-backdrop-filter: blur(20px);
}

.padded {
	padding: 2rem;
}

@media (max-width: 500px) {
	.padded {
		padding: 1rem;
	}
}

/* Header */
.header-container {
	perspective: 100vw;
	perspective-origin: 50% 30vh;
	transform-style: preserve-3d;
}
header {
	font-family: var(--font-family-monospace);
	text-align: center;
	align-items: center;
	padding: 4rem 0;
	margin: 2rem auto 4rem;
	max-width: 90rem;
	z-index: 128;
}

@media (max-width: 90rem) {
	header {
		margin: 2rem 1rem 3rem;
	}
}

@media (max-width: 40rem) {
	header.panel {
		background: none;
		box-shadow: none;
		backdrop-filter: none;
		-webkit-backdrop-filter: none;
		margin: 2rem 1rem;
	}
}

.wordart {
	display: inline-block;
	margin: 2rem 0 4rem;
	font-size: 9vw;
	text-shadow: none;
	background: linear-gradient(
		183deg,
		rgba(183, 0, 255, 0.7) 10%,
		rgba(255, 21, 200, 0.7) 70%
	);
	background-clip: text;
	-webkit-background-clip: text;
	color: transparent;
	font-family: "Impact";
	transform: skewY(-8deg) scaleY(1.3) scaleX(0.8);
	-webkit-text-stroke: 1px rgba(255, 255, 255, 0.25);
}

.wordart-wrapper {
	filter: drop-shadow(2px 2px 0px rgba(2, 5, 42, 0.8));
}

@media (min-width: 1400px) {
	.wordart {
		font-size: 8rem;
	}
}

/* Nav */
nav {
	max-width: 22rem;
	margin: 0 auto;
	margin-bottom: -8rem;
}
nav.secondary {
	margin: 1rem auto 2rem;
}
.nav {
	display: flex;
	justify-content: space-between;
	padding: 1.5rem 1rem;
	list-style: none;
}
.nav-item {
	display: inline-block;
	padding: 0 1rem;
}
.nav-item a[href]:not(:hover) {
	text-decoration: none;
}
.nav a[href][aria-current="page"] {
	color: #fff;
}

@media (max-width: 40rem) {
	nav {
		margin-bottom: -7rem;
	}
}

/* Internal header */
header.internal {
	display: flex;
	max-width: 100%;
	padding: 0;
	margin: 0;
}

header.internal .home-link {
	width: 300px;
	margin-right: auto;
}

header.internal .wordart {
	font-size: 2rem;
	margin: 0;
}

header.internal nav {
	background: none;
	box-shadow: none;
	filter: none;
	-webkit-backdrop-filter: none;
	max-width: 100%;
	margin: 2rem;
}

header.internal ul.nav {
	padding: 1rem 0 0;
}

@media (max-width: 500px) {
	header.internal,
	header,
	header.panel {
		display: block;
		max-width: 100%;
		padding: 0;
		margin: 2rem 0 0;
	}

	header .home-link {
		width: 300px;
		margin-right: auto;
	}

	header .wordart {
		font-size: 2rem;
		margin: 0;
	}

	nav,
	header .panel {
		background: none;
		box-shadow: none;
		filter: none;
		-webkit-backdrop-filter: none;
		max-width: 100%;
		margin: 2rem;
	}

	header .nav {
		padding: 1rem 0 0;
	}
}

/* Posts list */
.postlist {
	list-style: none;
	padding: 0;
}
.home.postlist {
	display: flex;
	flex-wrap: wrap;
	padding: 0 2rem;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
}

.home .postlist-item {
	margin: 1rem;
	max-width: calc(33% - 2rem);
	width: 100%;
	padding: 2rem;
}
@media (max-width: 70rem) {
	.home .postlist-item {
		max-width: calc(50% - 2rem);
	}
}

@media (max-width: 48rem) {
	.home .postlist-item {
		max-width: 100%;
	}
}

.nested .postlist-item {
	padding-top: 0;
	padding-bottom: 0;
}
.postlist-item time {
	width: 100%;
}
.postlist-item img,
main img {
	max-width: 100%;
	height: auto;
	margin: 3rem 0;
	border-radius: 2rem;
	box-shadow: -0.25px -0.25px 0.25px 0 rgba(255, 255, 255, 0.5),
		0 0 1rem 0 rgba(0, 0, 0, 0.2);
}

.video-wrapper {
	width: 100%;
}
main video {
	display: block;
	max-width: 80%;
	height: auto;
	border-radius: 2rem;
	box-shadow: -0.25px -0.25px 0.25px 0 rgba(255, 255, 255, 0.5),
		0 0 1rem 0 rgba(0, 0, 0, 0.2);
}
.postlist-date,
.postlist-item:before {
	font-size: 0.8125em; /* 13px /16 */
	color: var(--color-gray-70);
}
.postlist-date {
	word-spacing: -0.5px;
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}
.postlist h2,
.postlist h3,
.postlist h4 {
	display: block;
	width: 100%;
}

.more-posts {
	text-align: center;
	margin: 2rem 0;
}

.content {
	max-width: 54rem;
	margin-left: auto;
	margin-right: auto;
}
.content h2,
.content h3,
.content h4 {
	margin-top: 2rem;
	margin-bottom: 0;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	text-transform: capitalize;
	text-decoration: none;
	background: rgba(255, 255, 255, 0.1);
	padding: 0.25rem 0.5rem;
	border: 0.5px solid rgba(255, 255, 255, 0.25);
	border-radius: 1rem;
	box-shadow: -0.25px -0.25px 0.25px 0 rgba(255, 255, 255, 0.5),
		0 0 1rem 0 rgba(0, 0, 0, 0.2);
	font-size: 0.75em; /* 12px /16 */
	opacity: 0.5;
}
.post-tag:hover {
	opacity: 1;
	transition: opacity 0.25s ease-out;
}
.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: 0.5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-right: 1em;
}

/* Direct Links / Markdown Headers */
.header-anchor {
	text-decoration: none;
	font-style: normal;
	font-size: 1em;
	margin-left: 0.1em;
	text-shadow: none;
}
a[href].header-anchor,
a[href].header-anchor:visited {
	color: transparent;
}
a[href].header-anchor:focus,
a[href].header-anchor:hover {
	text-decoration: underline;
}
a[href].header-anchor:focus,
:hover > a[href].header-anchor {
	color: #aaa;
}

main h1,
main h2,
main h3,
main h4 {
	font-family: var(--font-family);
	width: 100%;
}

h2 + .header-anchor {
	font-size: 1.5em;
}

footer {
	max-width: 80rem;
	margin: 2rem auto;
	text-align: center;
}

@media (max-width: 90rem) {
	footer {
		margin: 1rem;
	}
}

.signup-frame {
	max-width: 375px;
	margin: 0 auto;
}

@media (max-width: 30rem) {
	.imgur-embed-iframe-pub {
		margin: 0 -2rem !important;
		max-width: calc(100% + 4rem);
	}
}</style>
		<script src="/js/on-scroll.js"></script>
	</head>
	<body>
		<div class="bodyBackground"></div>
		<a href="#skip" class="visually-hidden">Skip to main content</a>
			<header class="internal">
				<a href="/" class="home-link">
					<span class="wordart-wrapper">
						<span class="wordart">Donovan’s Vision Blog</span>
					</span>
				</a>
				<nav class="panel">
					<h2 class="visually-hidden">Top level navigation menu</h2>
					<ul class="nav">
						<li class="nav-item"><a href="/">Home</a></li>
						<li class="nav-item"><a href="/blog/">All Posts</a></li>
						<li class="nav-item"><a href="/links/">Cool Links</a></li>
					</ul>
				</nav>
			</header>
		<main id="skip" class="">
			
<div class="content panel padded">
	<h1>Immersive spaces</h1>

<ul class="post-metadata">
	<li><time datetime="2024-06-13">13 June 2024</time></li>
	<li><a href="/tags/dev/" class="post-tag">dev</a></li>
</ul>

<p>This post will cover what an <a href="https://developer.apple.com/documentation/swiftui/immersivespace">immersive space</a> is, when you might want to use it, and how to set it up in Xcode.</p>
<h2 id="immersive-space" tabindex="-1">Immersive space <a class="header-anchor" href="#immersive-space">#</a></h2>
<p>Unlike a <a href="/blender-file-in-vision/">windowed window</a>, or a <a href="http://localhost:8080/volumetric-window-group/">volumetric window</a>, an <em>immersive space</em> is an unbounded space within which you can display content. You can use it when you want to remove all other distractions, and place your app either in a mixed environment, in which the user's view is still visible, or a fully immersive environment in which your app takes over the entire view.</p>
<p>This can be useful if you want to create an app that exists within the environment but not be bounded by the boxes of windows or volumes.</p>
<h3 id="when-it-s-useful" tabindex="-1">When it's useful <a class="header-anchor" href="#when-it-s-useful">#</a></h3>
<p>An immersive space will remove all other apps when opened. It can be useful for creating focused apps or apps that may involve multiple personas.</p>
<p>If you want to create window-style apps with related windows that may be 3D, then a volumetric window can be a better fit as the positioning is then handled automatically.</p>
<p>An immersive space is best when you want to have control over positioning in relation to the user.</p>
<h2 id="demo" tabindex="-1">Demo <a class="header-anchor" href="#demo">#</a></h2>
<p>Here's the simple demo top show how an immersive view can be triggered.</p>
<h3 id="before" tabindex="-1">Before <a class="header-anchor" href="#before">#</a></h3>
<p><picture><source type="image/avif" srcset="/img/MWmWdtD4E8-1762.avif 1762w"><source type="image/webp" srcset="/img/MWmWdtD4E8-1762.webp 1762w"><img alt="Simulator showing a window with toggle button" loading="lazy" decoding="async" src="/img/MWmWdtD4E8-1762.png" width="1762" height="1278"></picture></p>
<h3 id="after" tabindex="-1">After <a class="header-anchor" href="#after">#</a></h3>
<p><picture><source type="image/avif" srcset="/img/SdomvLtQxs-1726.avif 1726w"><source type="image/webp" srcset="/img/SdomvLtQxs-1726.webp 1726w"><img alt="Toggle button pressed, orb showing" loading="lazy" decoding="async" src="/img/SdomvLtQxs-1726.png" width="1726" height="1328"></picture></p>
<h2 id="app-view" tabindex="-1">App view <a class="header-anchor" href="#app-view">#</a></h2>
<p>Beginning with your app's App view, add an <code>ImmersiveSpace</code> as follows:</p>
<pre class="language-swift" tabindex="0"><code class="language-swift"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> currentStyle<span class="token punctuation">:</span> <span class="token class-name">ImmersionStyle</span> <span class="token operator">=</span> <span class="token punctuation">.</span>mixed

<span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">Scene</span> <span class="token punctuation">{</span>
    <span class="token class-name">WindowGroup</span> <span class="token punctuation">{</span>
        <span class="token class-name">ContentView</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">ImmersiveSpace</span><span class="token punctuation">(</span>id<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"ImmersiveSpace"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ImmersiveView</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">immersionStyle</span><span class="token punctuation">(</span>selection<span class="token punctuation">:</span> $currentStyle<span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token punctuation">.</span>mixed<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<p>Note that <code>currentStyle</code> is also specified here, so the user can choose to enter a full or mixed immersive space as needed. Within the <code>ImmersiveSpace</code>, <code>ImmersiveView()</code> is shown.</p>
<h2 id="immersiveview" tabindex="-1">ImmersiveView <a class="header-anchor" href="#immersiveview">#</a></h2>
<p>The ImmersiveView is a simple <code>RealityView</code> that displays a sphere model. Since objects in an immersive space are not set within bounds like windows, positioning takes place from ground level where the user's feet are. In this case I'm setting <code>y</code> to <code>0.5</code>, which lifts the sphere 0.5m from the ground and setting <code>z</code> to <code>-1</code> to bring the away from the user.</p>
<pre class="language-swift" tabindex="0"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span>
<span class="token keyword">import</span> <span class="token class-name">RealityKit</span>
<span class="token keyword">import</span> <span class="token class-name">RealityKitContent</span>

<span class="token keyword">struct</span> <span class="token class-name">ImmersiveView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span>
        <span class="token class-name">RealityView</span> <span class="token punctuation">{</span> content <span class="token keyword">in</span>
            <span class="token keyword">let</span> model <span class="token operator">=</span> <span class="token class-name">ModelEntity</span><span class="token punctuation">(</span>
                 mesh<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">generateSphere</span><span class="token punctuation">(</span>radius<span class="token punctuation">:</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                 materials<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">SimpleMaterial</span><span class="token punctuation">(</span>color<span class="token punctuation">:</span> <span class="token punctuation">.</span>white<span class="token punctuation">,</span> isMetallic<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            model<span class="token punctuation">.</span>scale <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
            model<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">0.5</span>
            model<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
            content<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>We then bring it together with the <code>ContentView</code> to handle showing the immersive space.</p>
<h2 id="contentview" tabindex="-1">ContentView <a class="header-anchor" href="#contentview">#</a></h2>
<p>In the content view we use <code>openImmersiveSpace</code> and <code>dismissImmersiveSpace</code> to show and hide the immersive space. In the UI we have a toggle button which when pressed, calls the <code>showImmersiveSpace</code>. Lastly there's an <code>onChange</code> to handle setting whether the space is shown or not.</p>
<pre class="language-swift" tabindex="0"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span>
<span class="token keyword">import</span> <span class="token class-name">RealityKit</span>
<span class="token keyword">import</span> <span class="token class-name">RealityKitContent</span>

<span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span>
    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> showImmersiveSpace <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> immersiveSpaceIsShown <span class="token operator">=</span> <span class="token boolean">false</span>

    <span class="token attribute atrule">@Environment</span><span class="token punctuation">(</span><span class="token punctuation">\</span><span class="token punctuation">.</span>openImmersiveSpace<span class="token punctuation">)</span> <span class="token keyword">var</span> openImmersiveSpace
    <span class="token attribute atrule">@Environment</span><span class="token punctuation">(</span><span class="token punctuation">\</span><span class="token punctuation">.</span>dismissImmersiveSpace<span class="token punctuation">)</span> <span class="token keyword">var</span> dismissImmersiveSpace

    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span>
        <span class="token class-name">VStack</span> <span class="token punctuation">{</span>
            <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Ponder the orb"</span></span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>extraLargeTitle<span class="token punctuation">)</span>

            <span class="token class-name">Toggle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Show Immersive Space"</span></span><span class="token punctuation">,</span> isOn<span class="token punctuation">:</span> $showImmersiveSpace<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">toggleStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>button<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">.</span>top<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span>of<span class="token punctuation">:</span> showImmersiveSpace<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token omit keyword">_</span><span class="token punctuation">,</span> newValue <span class="token keyword">in</span>
            <span class="token class-name">Task</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> newValue <span class="token punctuation">{</span>
                    <span class="token keyword">switch</span> <span class="token keyword">await</span> <span class="token function">openImmersiveSpace</span><span class="token punctuation">(</span>id<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"ImmersiveSpace"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">case</span> <span class="token punctuation">.</span>opened<span class="token punctuation">:</span>
                        immersiveSpaceIsShown <span class="token operator">=</span> <span class="token boolean">true</span>
                    <span class="token keyword">case</span> <span class="token punctuation">.</span>error<span class="token punctuation">,</span> <span class="token punctuation">.</span>userCancelled <span class="token punctuation">:</span>
                        <span class="token keyword">fallthrough</span>
                    <span class="token keyword">default</span><span class="token punctuation">:</span>
                        immersiveSpaceIsShown <span class="token operator">=</span> <span class="token boolean">false</span>
                        showImmersiveSpace <span class="token operator">=</span> <span class="token boolean">false</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> immersiveSpaceIsShown <span class="token punctuation">{</span>
                    <span class="token keyword">await</span> <span class="token function">dismissImmersiveSpace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    immersiveSpaceIsShown <span class="token operator">=</span> <span class="token boolean">false</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>With that we can toggle the immersive space, and display content within it.</p>
<h2 id="creating-an-immersive-first-app" tabindex="-1">Creating an immersive-first app <a class="header-anchor" href="#creating-an-immersive-first-app">#</a></h2>
<p>If you don't want to make use of the toggle to switch into immersive mode, you can update the app to be in immersive mode by default. In <code>info.plist</code>, update the following:</p>
<pre><code>Preferred Default Scene Session Role: Window Application Session Role
</code></pre>
<p>Change it to:</p>
<pre><code>Preferred Default Scene Session Role: Immersive Space Application Session Role
</code></pre>
<p>That should start the app in immersive space.</p>
<p>Alternately, you can change the <code>.onChange(of: showImmersiveSpace)</code> block to instead run a <code>task</code> on load, replacing the <code>onChange</code> block to:</p>
<pre class="language-swift" tabindex="0"><code class="language-swift"><span class="token punctuation">.</span>task <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">openImmersiveSpace</span><span class="token punctuation">(</span>id<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"ImmersiveSpace"</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>

<ul class="links-nextprev"><li>Previous: <a href="/volumetric-window-group/">Volumetric windows</a></li><li>Next: <a href="/drag-gesture/">Dragging objects</a></li>
</ul>
</div>

		</main>

		<footer class="panel padded">
			<div class="signup">
				<h2>Donovan's Vision Newsletter</h2>
				<p>Stay up to date when new posts land</p>
				<div class="signup-frame">
					<iframe
					src="https://embeds.beehiiv.com/e4b485a8-6ae4-48c8-a4aa-e699ebbc193f?slim=true"
					data-test-id="beehiiv-embed"
					height="52"
					width="100%"
					frameborder="0"
					scrolling="no"
					style="margin: 1rem 0 2rem; border-radius: 0px !important; background-color: transparent;"
					></iframe>
				</div>
			</div>
			<nav class="panel secondary">
					<h2 class="visually-hidden">Footer navigation menu</h2>
					<ul class="nav">
						<li class="nav-item"><a href="/">Home</a></li>
						<li class="nav-item"><a href="/blog/">All Posts</a></li>
						<li class="nav-item"><a href="/links/">Cool Links</a></li>
					</ul>
				</nav>
				<p>This website is built on <a href="http://eleventy-base-blog.netlify.app">Eleventy Base Blog</a> with a few small tweaks.</p>

			<p>Thanks for reading, be sure to check out <a href="/feed/feed.xml">the RSS feed</a>.</p>
				<p>All content @2024 <a href="https://hop.ie">Donovan Hutchinson</a></p>
		</footer>

		<!-- Current page: /immersive-spaces/ -->
	</body>
</html>
