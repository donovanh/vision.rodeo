<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Reps Dev Diary #1 - Donovan's Vision Blog</title>
		<meta name="description" content="A diary about an app I&#39;m working on">
		<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
		<link rel="manifest" href="/site.webmanifest">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Donovan’s Vision Blog">
		<link rel="alternate" href="/feed/feed.json" type="application/json" title="Donovan’s Vision Blog">
		<meta name="generator" content="Eleventy v2.0.1">
		<style>/**
 * okaidia theme for JavaScript, CSS and HTML
 * Loosely based on Monokai textmate theme by http://www.monokai.nl/
 * @author ocodia
 */

code[class*="language-"],
pre[class*="language-"] {
	color: #f8f8f2;
	background: none;
	text-shadow: 0 1px rgba(0, 0, 0, 0.3);
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
	border-radius: 0.3em;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #272822;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: #8292a2;
}

.token.punctuation {
	color: #f8f8f2;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.constant,
.token.symbol,
.token.deleted {
	color: #f92672;
}

.token.boolean,
.token.number {
	color: #ae81ff;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #a6e22e;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string,
.token.variable {
	color: #f8f8f2;
}

.token.atrule,
.token.attr-value,
.token.function,
.token.class-name {
	color: #e6db74;
}

.token.keyword {
	color: #66d9ef;
}

.token.regex,
.token.important {
	color: #fd971f;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
/*
 * New diff- syntax
 */

pre[class*="language-diff-"] {
	--eleventy-code-padding: 1.25em;
	padding-left: var(--eleventy-code-padding);
	padding-right: var(--eleventy-code-padding);
}
.token.deleted {
	background-color: hsl(0, 51%, 37%);
	color: inherit;
}
.token.inserted {
	background-color: hsl(126, 31%, 39%);
	color: inherit;
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	-webkit-user-select: none;
	user-select: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding-top: 2px;
	padding-bottom: 2px;
}
.token.prefix.inserted,
.token.prefix.deleted {
	width: var(--eleventy-code-padding);
	background-color: rgba(0,0,0,.2);
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	margin-left: calc(-1 * var(--eleventy-code-padding));
	margin-right: calc(-1 * var(--eleventy-code-padding));
	text-decoration: none; /* override del, ins, mark defaults */
	color: inherit; /* override del, ins, mark defaults */
}
* { box-sizing: border-box; }
/* Defaults */
:root {
	--font-family: -apple-system, system-ui, sans-serif;
	--font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono,
		Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono,
		Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New,
		Courier, monospace;
}

/* Theme colors */
:root {
	--color-gray-70: rgba(255, 255, 255, 0.3);
	--color-gray-50: rgba(255, 255, 255, 0.5);
	--color-gray-20: rgba(255, 255, 255, 0.8);

	--background-color: #241653;

	--text-color: var(--color-gray-20);
	--text-color-link: rgba(241, 233, 255, 0.8);
	--text-color-link-active: rgba(241, 233, 255, 1);
	--text-color-link-visited: rgba(241, 233, 255, 0.5);

	--syntax-tab-size: 2;
}

/* TODO: Make a proper dark theme? */
/* @media (prefers-color-scheme: dark) {
	:root {
		--color-gray-20: #e0e0e0;
		--color-gray-50: #c0c0c0;
		--color-gray-70: #dad8d8;

		/* --text-color is assigned to --color-gray-_ above 
		--text-color-link: #1493fb;
		--text-color-link-active: #6969f7;
		--text-color-link-visited: #a6a6f8;

		--background-color: #15202b;
	}
} */

/* Global stylesheet */
* {
	box-sizing: border-box;
}

html,
body {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	color: var(--text-color);
	text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
	/* TODO: Have this dynamically change by time of day */
	background-image: linear-gradient(
			to bottom,
			rgba(255, 240, 255, 0.2),
			rgba(120, 20, 90, 0.6)
		),
		url("/img/office.webp");
	background-attachment: fixed;
	background-size: cover;
}
html {
	overflow-y: scroll;
}

.bodyBackground {
	opacity: 0;
}

@media (max-width: 500px) {
	body {
		background: rgb(40, 40, 40);
	}
	.bodyBackground {
		opacity: 1;
		position: absolute;
		bottom: 0;
		left: 0;
		right: 0;
		top: 0;
		background-size: cover;
		background-image: linear-gradient(
				to bottom,
				rgba(245, 246, 252, 0.52),
				rgba(117, 19, 93, 0.73),
				rgb(40, 40, 40)
			),
			url("/img/office.webp");
		background-repeat: no-repeat;
	}
}

.bodyBGCover {
	position: fixed;
	top: 0;
	right: 0;
	bottom: 0;
	left: 0;
	background: rgba(0, 0, 0, 0.75);
	opacity: 0;
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

li {
	line-height: 1.5;
}

a[href] {
	color: var(--text-color-link);
}
a[href]:visited {
	color: var(--text-color-link-visited);
}
a[href]:hover,
a[href]:active {
	color: var(--text-color-link-active);
}

main {
	padding: 1rem;
}
/* main.animated {
	animation: slide-up 0.5s cubic-bezier(0, 1, 0.3, 1);
} */
main :first-child {
	margin-top: 0;
}

.links-nextprev {
	list-style: none;
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}

table {
	margin: 1em 0;
}
table td,
table th {
	padding-right: 1em;
}

pre,
code {
	font-family: var(--font-family-monospace);
}
pre:where([class*="language-"]) {
	width: 100%;
}
pre:not([class*="language-"]) {
	margin: 0.5em 0;
	line-height: 1.375; /* 22px /16 */
	-moz-tab-size: var(--syntax-tab-size);
	-o-tab-size: var(--syntax-tab-size);
	tab-size: var(--syntax-tab-size);
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
}
code {
	word-break: break-all;
}

.panel {
	background-color: rgba(200, 180, 200, 0.2);
	box-shadow: -0.25px -0.25px 0.25px 0 rgba(255, 255, 255, 0.75),
		0 0 1rem 0 rgba(0, 0, 0, 0.1);
	border-radius: 2.5rem;
	position: relative;
	backdrop-filter: blur(20px);
	-webkit-backdrop-filter: blur(20px);
}

.padded {
	padding: 2rem 4rem;
}

@media (max-width: 500px) {
	.padded {
		padding: 1rem;
	}
}

/* Header */
.header-container {
	perspective: 100vw;
	perspective-origin: 50% 30vh;
	transform-style: preserve-3d;
}
header {
	font-family: var(--font-family-monospace);
	text-align: center;
	align-items: center;
	padding: 4rem 0;
	margin: 2rem auto 4rem;
	max-width: 90rem;
	z-index: 128;
}

@media (max-width: 90rem) {
	header {
		margin: 2rem 1rem 3rem;
	}
}

@media (max-width: 40rem) {
	header.panel {
		background: none;
		box-shadow: none;
		backdrop-filter: none;
		-webkit-backdrop-filter: none;
		margin: 2rem 1rem;
	}
}

/* header.animated {
	animation: fade-in 1s ease-out, pop-in 1s cubic-bezier(0, 1, 0.3, 1);
} */

@keyframes fade-in {
	0% {
		opacity: 0;
	}
	100% {
		opacity: 1;
	}
}

@keyframes pop-in {
	0%,
	20% {
		transform: translateZ(-500px) rotateX(-45deg);
	}
	100% {
		transform: none;
	}
}

@keyframes slide-up {
	0% {
		transform: translateY(50px);
	}
	100% {
		transform: none;
	}
}

.wordart {
	display: inline-block;
	margin: 2rem 0 4rem;
	font-size: 9vw;
	text-shadow: none;
	background: linear-gradient(
		183deg,
		rgba(183, 0, 255, 0.7) 10%,
		rgba(255, 21, 200, 0.7) 70%
	);
	background-clip: text;
	-webkit-background-clip: text;
	color: transparent;
	font-family: "Impact";
	transform: skewY(-8deg) scaleY(1.3) scaleX(0.8);
	-webkit-text-stroke: 1px rgba(255, 255, 255, 0.25);
}

.wordart-wrapper {
	filter: drop-shadow(2px 2px 0px rgba(2, 5, 42, 0.8));
}

@media (min-width: 1400px) {
	.wordart {
		font-size: 8rem;
	}
}

@media (max-width: 500px) {
	.wordart-wrapper {
		width: 100%;
		position: absolute;
		left: 0;
		top: -40px;
	}
	.wordart {
		font-size: 2.5rem;
	}
}

/* Nav */
nav {
	max-width: 22rem;
	margin: 0 auto;
	margin-bottom: -8rem;
}
nav.secondary {
	margin: 1rem auto 2rem;
}
.nav {
	display: flex;
	justify-content: space-between;
	padding: 1.5rem 1rem;
	list-style: none;
}
.nav-item {
	display: inline-block;
	padding: 0 1rem;
}
.nav-item a[href]:not(:hover) {
	text-decoration: none;
}
.nav a[href][aria-current="page"] {
	color: #fff;
}

@media (max-width: 40rem) {
	nav {
		margin-bottom: -7rem;
	}
}

/* Posts list */
.postlist {
	list-style: none;
	padding: 0;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
	margin-bottom: 1em;
}
.home .postlist-item {
	padding-bottom: 4rem;
}
.nested .postlist-item {
	padding-top: 0;
	padding-bottom: 0;
}
.postlist-item time {
	width: 100%;
}
.postlist-item img,
main img {
	max-width: 100%;
	height: auto;
	border-radius: 2rem;
	box-shadow: -0.25px -0.25px 0.25px 0 rgba(255, 255, 255, 0.5),
		0 0 1rem 0 rgba(0, 0, 0, 0.2);
}
.video-wrapper {
	width: 100%;
}
main video {
	display: block;
	max-width: 100%;
	height: auto;
	border-radius: 2rem;
	box-shadow: -0.25px -0.25px 0.25px 0 rgba(255, 255, 255, 0.5),
		0 0 1rem 0 rgba(0, 0, 0, 0.2);
}
.postlist-date,
.postlist-item:before {
	font-size: 0.8125em; /* 13px /16 */
	color: var(--color-gray-70);
}
.postlist-date {
	word-spacing: -0.5px;
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}
.postlist h2,
.postlist h3,
.postlist h4 {
	display: block;
	width: 100%;
}

.content {
	max-width: 60rem;
	margin-left: auto;
	margin-right: auto;
}
.content h2,
.content h3,
.content h4 {
	margin-top: 2rem;
	margin-bottom: 0;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	text-transform: capitalize;
	text-decoration: none;
	background: rgba(255, 255, 255, 0.1);
	padding: 0.25rem 0.5rem;
	border: 0.5px solid rgba(255, 255, 255, 0.25);
	border-radius: 1rem;
	box-shadow: -0.25px -0.25px 0.25px 0 rgba(255, 255, 255, 0.5),
		0 0 1rem 0 rgba(0, 0, 0, 0.2);
	font-size: 0.75em; /* 12px /16 */
	opacity: 0.5;
}
.post-tag:hover {
	opacity: 1;
	transition: opacity 0.25s ease-out;
}
.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: 0.5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-right: 1em;
}

/* Direct Links / Markdown Headers */
.header-anchor {
	text-decoration: none;
	font-style: normal;
	font-size: 1em;
	margin-left: 0.1em;
	text-shadow: none;
}
a[href].header-anchor,
a[href].header-anchor:visited {
	color: transparent;
}
a[href].header-anchor:focus,
a[href].header-anchor:hover {
	text-decoration: underline;
}
a[href].header-anchor:focus,
:hover > a[href].header-anchor {
	color: #aaa;
}

main h1,
main h2,
main h3,
main h4 {
	font-family: var(--font-family-monospace);
}

h2 + .header-anchor {
	font-size: 1.5em;
}

footer {
	max-width: 80rem;
	margin: 2rem auto;
	text-align: center;
}

@media (max-width: 90rem) {
	footer {
		margin: 1rem;
	}
}

.signup-frame {
	max-width: 375px;
	margin: 0 auto;
}</style>
		<script src="/js/on-scroll.js"></script>
	</head>
	<body>
		<div class="bodyBackground"></div>
		<div class="bodyBGCover" id="overlay"></div>
		<a href="#skip" class="visually-hidden">Skip to main content</a>

		<div class="header-container">
			<header class="panel " id="header">
				<a href="/" class="home-link">
					<span class="wordart-wrapper">
						<span class="wordart">Donovan’s Vision Blog</span>
					</span>
				</a>
				<nav class="panel">
					<h2 class="visually-hidden">Top level navigation menu</h2>
					<ul class="nav">
						<li class="nav-item"><a href="/">Home</a></li>
						<li class="nav-item"><a href="/blog/">All Posts</a></li>
						<li class="nav-item"><a href="/links/">Cool Links</a></li>
					</ul>
				</nav>
			</header>
			</div>
		<main id="skip" class="">
			
<div class="content panel padded">
	<h1>Reps Dev Diary #1</h1>

<ul class="post-metadata">
	<li><time datetime="2024-02-09">09 February 2024</time></li>
	<li><a href="/tags/dev/" class="post-tag">dev</a></li>
	<li><a href="/tags/dev-diary/" class="post-tag">dev-diary</a></li>
</ul>

<p>The following is a log of the process of designing and building an app, while learning Swift and SwiftUI.</p>
<p>The following represents the result of my poking around in XCode for about 6 months. I'd like to do smaller, more regular updates. By reading this, you're helping me by providing me accountability. Thank you!</p>
<h2 id="my-goals-for-this-app" tabindex="-1">My goals for this app <a class="header-anchor" href="#my-goals-for-this-app">#</a></h2>
<p>I'm interested in building apps, not just for Vision Pro but also iOS. I enjoy creating things and was looking for a new challenge last year, so when the Vision Pro was announced I thought it was a good time to learn some <a href="https://developer.apple.com/xcode/swiftui/">Swift UI</a>.</p>
<p>For learning, I've been taking part in the amazing sessions over at <a href="http://hackingwithswift.com">Hacking with Swift</a>. I'd very much recommend Paul's <a href="http://hackingwithswift.com/plus">HWS+</a> program but also the <a href="https://www.hackingwithswift.com/100/swiftui">100 Days of SwiftUI</a> is one of the best online learning resources I've ever experienced. And it's free!</p>
<p>I learn best when building so I also decided to build myself an app as a side project.</p>
<h2 id="app-idea" tabindex="-1">App idea <a class="header-anchor" href="#app-idea">#</a></h2>
<p>My side project app idea is a bodyweight exercise tracking app, codenamed &quot;Reps&quot;. I've been interested in callisthenics for a long time and a fan of the <a href="https://www.dragondoor.com/b41/">Convict Conditioning</a> training approach.</p>
<p>I have been out of practice recently and would like to get back into training again and enjoy the structure Convict Conditioning affords. However I would like to have an app that helps with the logging, as I find keeping a log quite helpful as a motivation:</p>
<p><picture><source type="image/avif" srcset="/img/920lBpLOur-1200.avif 1200w"><source type="image/webp" srcset="/img/920lBpLOur-1200.webp 1200w"><img alt="A month's training, from back when I had more discipline." loading="lazy" decoding="async" src="/img/920lBpLOur-1200.jpeg" width="1200" height="900"></picture></p>
<p>So that's where I'm starting. An app to track, log and maybe do more interesting things with training data.</p>
<h2 id="minimum-viable-product" tabindex="-1">Minimum viable product <a class="header-anchor" href="#minimum-viable-product">#</a></h2>
<p>The minimum product I'll need to start is a way to set up an exercise routine, then record my reps for each exercise. Other features like analysing the saved data can wait.</p>
<p>This means at minimum this app will need:</p>
<ul>
<li>A set of data defining the exercises and their progressions</li>
<li>Illustrations for each progression that help me know what the exercise involves</li>
<li>A way of setting up a weekly schedule</li>
<li>A way of seeing what my workout is for today</li>
<li>A way to record today's exercises</li>
</ul>
<h2 id="step-0-paper-sketching" tabindex="-1">Step 0: Paper sketching <a class="header-anchor" href="#step-0-paper-sketching">#</a></h2>
<p><picture><source type="image/avif" srcset="/img/xX0Z9HPo-7-1280.avif 1280w"><source type="image/webp" srcset="/img/xX0Z9HPo-7-1280.webp 1280w"><img alt="Thinking through some flows on paper." loading="lazy" decoding="async" src="/img/xX0Z9HPo-7-1280.jpeg" width="1280" height="960"></picture></p>
<p>It's hard to just jump in and start coding, so I took a while to sketch out some (vague) notions for how the flows might work. While far from an actionable design, it got me thinking about the kinds of things I'd be showing and what data I would need.</p>
<h2 id="step-1-data-and-data-structure" tabindex="-1">Step 1: Data and data structure <a class="header-anchor" href="#step-1-data-and-data-structure">#</a></h2>
<p>To drive the views I need to set up some useful data. The purpose of this app is to guide the user along a series of exercise progressions.</p>
<p>I decided to set up a structure similar to the Convict Conditioning guide. In it there are six exercise types: pushups, pullups, leg raises, squats, bridges and handstand pushups.</p>
<p>Each exercise type has 10 progressions, ranging from easiest to hardest. Within each progression, there are 3 levels: beginner, intermediate, and progression level (which when completed allows you to progress to the next... progression). Naming is hard.</p>
<p>To get it started in XCode, I set up the data like this:</p>
<pre class="language-swift" tabindex="0"><code class="language-swift"><span class="token keyword">let</span> pushupDataSet<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Progression</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token class-name">Progression</span><span class="token punctuation">(</span>stage<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token punctuation">.</span>pushup<span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token punctuation">.</span>wallPushups<span class="token punctuation">,</span> reps<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">.</span>beginner<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>intermediate<span class="token punctuation">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>progression<span class="token punctuation">:</span> <span class="token number">50</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span> sets<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">.</span>beginner<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>intermediate<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>progression<span class="token punctuation">:</span> <span class="token number">3</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span> animationFileName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"pushup-01"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">Progression</span><span class="token punctuation">(</span>stage<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token comment">//... and so on, 10 for each exercise type</span></code></pre>
<p>In this we have the progression's stage (0 through 9), an exercise type, name, and then a dictionary for each of reps and sets.</p>
<p>The <code>type</code> is an enum of exercise types, such as <code>.pushup</code>, <code>.pullup</code>, etc. This makes it easier to use <code>ExerciseType</code> values in my code.</p>
<p>For the name, I use a <a href="https://developer.apple.com/documentation/foundation/localizedstringresource">LocalizedStringResource</a> enum:</p>
<pre class="language-swift" tabindex="0"><code class="language-swift"><span class="token keyword">enum</span> <span class="token class-name">ProgressionName</span><span class="token punctuation">:</span> <span class="token class-name">LocalizedStringResource</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> shortBridges <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"Short bridges"</span></span>
    <span class="token keyword">case</span> straightBridges <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"Straight bridges"</span></span>
    <span class="token comment">// etc</span></code></pre>
<p>This will make it easier to translate than having hard-coded names in the data object.</p>
<p>Lastly I later added in <code>animationFileName</code> - this is a string referencing the file name of the animation file I'll use to illustrate each progression.</p>
<p>So, 6 sets of exercise progressions, each of which has their own definitions of their sets and reps.</p>
<p>With this data set up, I needed to learn how to make some 3D assets to illustrate them.</p>
<h2 id="step-2-illustrations-3d-animations" tabindex="-1">Step 2: Illustrations (3D animations) <a class="header-anchor" href="#step-2-illustrations-3d-animations">#</a></h2>
<p>I'd like to keep my options open for porting this app to Vision Pro, and a big part of that means having 3D assets.</p>
<p>I have a small amount of 3D experience from back in college days but I was basically starting from scratch.</p>
<h3 id="blender" tabindex="-1">Blender <a class="header-anchor" href="#blender">#</a></h3>
<p>To save some time, I downloaded <a href="http://www.blendswap.com/blends/view/74733">this free mannequin model</a>. I'll need to find a way to add credit in the app, but hopefully this is a start.</p>
<p>I wasn't able to make use of the model with the existing rig, so ended up setting up a new rig myself for positioning. I then created an animation for each of the 60 progressions.</p>
<p><picture><source type="image/avif" srcset="/img/HCPlLcVefR-2554.avif 2554w"><source type="image/webp" srcset="/img/HCPlLcVefR-2554.webp 2554w"><img alt="Creating a pushup animation in Blender." loading="lazy" decoding="async" src="/img/HCPlLcVefR-2554.png" width="2554" height="1560"></picture></p>
<p>This took a while, close to 3 months. However I really like the result. Once I made the animations, the next challenge was bringing them into XCode.</p>
<h3 id="file-size-issues" tabindex="-1">File size issues <a class="header-anchor" href="#file-size-issues">#</a></h3>
<p>Embedding each animation file was over 5Mb in size. For 60 animations, that would mean at least 300Mb of files just for the animations. To work around this, I ended up saving one <code>base model</code> file, exported as a Collada (dae) file, and then setting up each of the others as just the animated rig without the model's mesh.</p>
<p>With this I could then load one 3D model, and for each animation load the animation file and apply the animation to the <code>base model</code>. This resulted in animation files around 1.5Mb each. I'm sure I could optimise more but bringing the assets under 100Mb seems like a good start.</p>
<h3 id="loading-3d-files-in-xcode" tabindex="-1">Loading 3D files in Xcode <a class="header-anchor" href="#loading-3d-files-in-xcode">#</a></h3>
<p>After a lot of Google-searching, I settled on using a <a href="https://developer.apple.com/documentation/scenekit/sceneview">SceneView</a> to load the base Collada file, as well as the animation file, then apply this animation to the scene. Lastly I also grab the camera from the animation file and apply that to the scene.</p>
<div class="video-wrapper">
    <video autoplay muted loop playsinline width="200">
    <source src="https://i.imgur.com/F0MSAMJ.mp4" type="video/mp4">
    </video>
</video>
<p>This method creates the scene and applies the animation and camera:</p>
<pre class="language-swift" tabindex="0"><code class="language-swift"><span class="token keyword">func</span> <span class="token function-definition function">loadScene</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> currentProgressionAnimationName<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> isPaused<span class="token punctuation">:</span> <span class="token class-name">Bool</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">SCNScene</span> <span class="token punctuation">{</span>
    <span class="token keyword">guard</span> <span class="token keyword">let</span> scene <span class="token operator">=</span> <span class="token class-name">SCNScene</span><span class="token punctuation">(</span>named<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"base-model"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token keyword">let</span> baseSceneSource <span class="token operator">=</span> <span class="token class-name">SCNSceneSource</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token class-name">Bundle</span><span class="token punctuation">.</span>main<span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span>forResource<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"base-model"</span></span><span class="token punctuation">,</span> withExtension<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"dae"</span></span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">,</span> options<span class="token punctuation">:</span> <span class="token nil constant">nil</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Scene could not be loaded"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token class-name">SCNScene</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">guard</span> <span class="token keyword">let</span> animationSceneSourceUrl <span class="token operator">=</span> <span class="token class-name">Bundle</span><span class="token punctuation">.</span>main<span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span>forResource<span class="token punctuation">:</span> currentProgressionAnimationName<span class="token punctuation">,</span> withExtension<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"dae"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token keyword">let</span> animationSceneSource <span class="token operator">=</span> <span class="token class-name">SCNSceneSource</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> animationSceneSourceUrl<span class="token punctuation">,</span> options<span class="token punctuation">:</span> <span class="token nil constant">nil</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Animation file \"</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">currentProgressionAnimationName</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">\" could not be loaded"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token class-name">SCNScene</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">let</span> animationIdentifier <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"action_container-rig"</span></span>
    <span class="token keyword">let</span> cameraIdentifier <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"Camera"</span></span>

    <span class="token keyword">if</span> <span class="token keyword">let</span> animationObj <span class="token operator">=</span> animationSceneSource<span class="token punctuation">.</span><span class="token function">entryWithIdentifier</span><span class="token punctuation">(</span>animationIdentifier<span class="token punctuation">,</span>
                                                     withClass<span class="token punctuation">:</span> <span class="token class-name">CAAnimation</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        animationObj<span class="token punctuation">.</span>repeatCount <span class="token operator">=</span> <span class="token punctuation">.</span>infinity
        scene<span class="token punctuation">.</span>rootNode<span class="token punctuation">.</span><span class="token function">addAnimation</span><span class="token punctuation">(</span>animationObj<span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> animationIdentifier<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Override camera position</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> animationSceneCameraNode <span class="token operator">=</span> animationSceneSource<span class="token punctuation">.</span><span class="token function">entryWithIdentifier</span><span class="token punctuation">(</span>cameraIdentifier<span class="token punctuation">,</span> withClass<span class="token punctuation">:</span> <span class="token class-name">SCNNode</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token keyword">let</span> existingCameraNode <span class="token operator">=</span> scene<span class="token punctuation">.</span>rootNode<span class="token punctuation">.</span><span class="token function">childNode</span><span class="token punctuation">(</span>withName<span class="token punctuation">:</span> cameraIdentifier<span class="token punctuation">,</span> recursively<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        existingCameraNode<span class="token punctuation">.</span><span class="token function">removeFromParentNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        scene<span class="token punctuation">.</span>rootNode<span class="token punctuation">.</span><span class="token function">addChildNode</span><span class="token punctuation">(</span>animationSceneCameraNode<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    scene<span class="token punctuation">.</span>isPaused <span class="token operator">=</span> isPaused
    scene<span class="token punctuation">.</span>background<span class="token punctuation">.</span>contents <span class="token operator">=</span> <span class="token class-name">Color</span><span class="token punctuation">.</span>clear

    <span class="token keyword">return</span> scene
<span class="token punctuation">}</span></code></pre>
<p>In a view, I can use this method it like this:</p>
<pre class="language-swift" tabindex="0"><code class="language-swift"><span class="token class-name">SceneView</span><span class="token punctuation">(</span>
  scene<span class="token punctuation">:</span> <span class="token function">loadScene</span><span class="token punctuation">(</span>animtionName<span class="token punctuation">)</span><span class="token punctuation">,</span>
  options<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">.</span>temporalAntialiasingEnabled<span class="token punctuation">]</span> <span class="token comment">// Other options can be used for control, etc</span>
<span class="token punctuation">)</span></code></pre>
<p>Notice I've an <code>isPaused</code> boolean. I can use this later to generate static images from the animations for use in badges and icons.</p>
<p>I've also set the background to <code>Color.clear</code>. However, that won't work yet. I needed some more work to give the animation a clear background.</p>
<h3 id="transparent-background" tabindex="-1">Transparent background <a class="header-anchor" href="#transparent-background">#</a></h3>
<p>Turns out a `SceneView`` doesn't support transparent backgrounds. The only way I could find to make the background transparent was to wrap the scene in a <a href="https://developer.apple.com/spritekit/">SpriteKit</a> view:</p>
<pre class="language-swift" tabindex="0"><code class="language-swift"><span class="token keyword">struct</span> <span class="token class-name">AnimationSpriteView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span>
    <span class="token attribute atrule">@State</span> <span class="token keyword">var</span> animationName<span class="token punctuation">:</span> <span class="token class-name">String</span>
    <span class="token keyword">var</span> isPaused<span class="token punctuation">:</span> <span class="token class-name">Bool</span>

    <span class="token keyword">var</span> createdScene<span class="token punctuation">:</span> <span class="token class-name">SKScene</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> scene <span class="token operator">=</span> <span class="token class-name">SKScene</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        scene<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token class-name">UIColor</span><span class="token punctuation">.</span>clear
        <span class="token keyword">let</span> model <span class="token operator">=</span> <span class="token class-name">SK3DNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        scene<span class="token punctuation">.</span>anchorPoint <span class="token operator">=</span> <span class="token class-name">CGPoint</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0.5</span><span class="token punctuation">)</span>
        model<span class="token punctuation">.</span>scnScene <span class="token operator">=</span> <span class="token function">loadScene</span><span class="token punctuation">(</span>animationName<span class="token punctuation">,</span> isPaused<span class="token punctuation">:</span> isPaused<span class="token punctuation">)</span>
        scene<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span>
        <span class="token keyword">return</span> scene
    <span class="token punctuation">}</span>

    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpriteView</span><span class="token punctuation">(</span>scene<span class="token punctuation">:</span> createdScene<span class="token punctuation">,</span> options<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">.</span>allowsTransparency<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>This creates a <a href="https://developer.apple.com/documentation/spritekit/sk3dnode">SK3DNode</a> as a model into which I load the scene above. I had to hack at the <code>anchorPoint</code> a bit, to get the model to sit correctly in the scene but these values seemed to work.</p>
<div class="video-wrapper">
    <video autoplay muted loop playsinline width="200">
    <source src="https://i.imgur.com/tMEmWl3.mp4" type="video/mp4">
    </video>
</video>
<h3 id="generating-icons" tabindex="-1">Generating icons <a class="header-anchor" href="#generating-icons">#</a></h3>
<p>With animations, I can now create posed versions to use as icons. I'm jumping around a bit here, I did the icons much more recently but it fits better here.</p>
<p>Since the animations have a transparent background, I can add some shapes behind and apply effects to make some icons:</p>
<div style="max-width: 220px">
<picture><source type="image/avif" srcset="/img/YAPLCmLIYW-636.avif 636w"><source type="image/webp" srcset="/img/YAPLCmLIYW-636.webp 636w"><img alt="Some ways I can use the animation object to create static icons." loading="lazy" decoding="async" src="/img/YAPLCmLIYW-636.png" width="636" height="1304"></picture>
</div>
<p>These icons make use of the animation view like so:</p>
<pre class="language-swift" tabindex="0"><code class="language-swift"><span class="token class-name">ZStack</span> <span class="token punctuation">{</span>
    <span class="token class-name">Circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>complete <span class="token operator">?</span> <span class="token class-name">Color</span><span class="token punctuation">.</span>themeColor<span class="token punctuation">.</span><span class="token function">opacity</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">.</span>gray<span class="token punctuation">.</span><span class="token function">opacity</span><span class="token punctuation">(</span><span class="token number">0.25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> size <span class="token operator">*</span> <span class="token number">0.7</span><span class="token punctuation">)</span>
    <span class="token class-name">Circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">.</span>white<span class="token punctuation">.</span><span class="token function">opacity</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> size <span class="token operator">*</span> <span class="token number">0.4</span><span class="token punctuation">)</span>
    <span class="token class-name">AnimationView</span><span class="token punctuation">(</span>progressionAnimationName<span class="token punctuation">:</span> name<span class="token punctuation">,</span> height<span class="token punctuation">:</span> size<span class="token punctuation">,</span> isPaused<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">grayscale</span><span class="token punctuation">(</span>complete <span class="token operator">?</span> <span class="token number">0.5</span> <span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">contrast</span><span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">shadow</span><span class="token punctuation">(</span>color<span class="token punctuation">:</span> <span class="token punctuation">.</span>white<span class="token punctuation">,</span> radius<span class="token punctuation">:</span> size <span class="token operator">*</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span>calculatedOffsets<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> size<span class="token punctuation">,</span> height<span class="token punctuation">:</span> size<span class="token punctuation">)</span></code></pre>
<p>This applies two circles within a ZStack, and scales according to a given <code>size</code> double. For the name, I'm passing a <code>pose</code> version of each animation. Since it's paused, I created a version of each animation with just a few frames, which brought down the size of each pose animation file to about 300Kb.</p>
<p>I've learned it's possible to apply some interesting visual effect modifiers! Here I'm using <code>greyscale</code> for showing a desaturated version when the exercise is incomplete, I'm upping the <code>contrast</code> a bit, and even adding a white glowing effect with <code>shadow</code>.</p>
<p>The <code>calculatedOffsets</code> value is from a dictionary of offsets I used to nudge each pose into the right position relative to the center of the icon. These are also expressed in points adjusted for the given <code>size</code> value, so it remains consistent at any size.</p>
<p>I'm hoping to get one for each progression. It's a lot of files but they look great and can scale to any size.</p>
<h2 id="step-3-views" tabindex="-1">Step 3: Views <a class="header-anchor" href="#step-3-views">#</a></h2>
<p>The structure of the app is simple enough - a home view containing today's exercises, a sheet that pops over to allow people to change each exercise's progression level, and another sheet where they can record the exercise.</p>
<p>I wracked my brain for a while on how to make this as simple as possible, and I think a decent approach is to have the idea of an &quot;edit mode&quot; within the home view. When in edit mode, selecting an exercise opens the change-progression sheet. Otherwise, selecting an exercise should let the user record an exercise.</p>
<p>It would be nice also if people can navigate through each day of the week (Mondays, Tuesdays, etc) and set the desired exercises to each day to manage the weekly routine.</p>
<h3 id="home-view" tabindex="-1">Home view <a class="header-anchor" href="#home-view">#</a></h3>
<div style="max-width: 294.5px; padding-top: 20px">
<picture><source type="image/avif" srcset="/img/VbgX4NXOpv-1179.avif 1179w"><source type="image/webp" srcset="/img/VbgX4NXOpv-1179.webp 1179w"><img alt="The app's home view." loading="lazy" decoding="async" src="/img/VbgX4NXOpv-1179.png" width="1179" height="2556"></picture>
</div>
<p>This is the main view of the app. It lists the exercises for the day. From here the main flow is to do a workout. Selecting an exercise or pressing the <code>Start workout</code> button opens the &quot;record exercise&quot; view in a sheet.</p>
<h3 id="displaying-exercises" tabindex="-1">Displaying exercises <a class="header-anchor" href="#displaying-exercises">#</a></h3>
<p>To show the right progressions, I make use of two objects persisted to <a href="https://developer.apple.com/documentation/foundation/userdefaults#">UserDefaults</a>. One being a dictionary of exercises by day as <code>[Int: [ExerciseType]]</code>. Each day of the week represented by an <code>Int</code> then stores an array of exercise types.</p>
<p>This allows me to list the right types of exercise for each day. To display the correct exercise progression, I have a store a dictionary of <code>UserExerciseStages</code>. For each <code>ExerciseType</code> I store the level and stage. I can then use that to ensure the correct progression is shown.</p>
<p>I store these both in <code>UserDefaults</code> as the amount of data needed is small enough not to need a larger store.</p>
<div style="max-width: 294.5px; padding-top: 20px">
<picture><source type="image/avif" srcset="/img/mQhWZsSjw0-1179.avif 1179w"><source type="image/webp" srcset="/img/mQhWZsSjw0-1179.webp 1179w"><img alt="Recording exercises." loading="lazy" decoding="async" src="/img/mQhWZsSjw0-1179.png" width="1179" height="2556"></picture>
</div>
<h3 id="recording-exercises" tabindex="-1">Recording exercises <a class="header-anchor" href="#recording-exercises">#</a></h3>
<p>The content of this sheet makes use of a view I called <code>ProgressionViewer</code>. It allows for scrolling through a series of progressions, and performing actions on them.</p>
<h3 id="progressionviewer" tabindex="-1">ProgressionViewer <a class="header-anchor" href="#progressionviewer">#</a></h3>
<p>The main scrolling takes place in a <a href="https://developer.apple.com/documentation/swiftui/scrollview">ScrollView</a> that I control using <a href="https://developer.apple.com/documentation/swiftui/scrollviewreader#">ScrollViewReader</a>:</p>
<pre class="language-swift" tabindex="0"><code class="language-swift"><span class="token class-name">ScrollViewReader</span> <span class="token punctuation">{</span> scrollViewValue <span class="token keyword">in</span>
    <span class="token class-name">ScrollView</span><span class="token punctuation">(</span><span class="token punctuation">.</span>horizontal<span class="token punctuation">,</span> showsIndicators<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">HStack</span><span class="token punctuation">(</span>spacing<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">ForEach</span><span class="token punctuation">(</span>progressions<span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> displayProgression <span class="token keyword">in</span>
            <span class="token comment">//... display the progression animation, title, etc</span>
            <span class="token punctuation">}</span>
            <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span>displayProgression<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> geo<span class="token punctuation">.</span>size<span class="token punctuation">.</span>width<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token function">onPreferenceChange</span><span class="token punctuation">(</span><span class="token class-name">ViewOffsetKey</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Calculate the currently shown index</span>
        <span class="token comment">// and update the animation file name</span>
        <span class="token comment">// offsets, etc</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token function">scrollTargetLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>This makes use of <code>id</code> set to the given progression so that I can scroll to it when needed, using:</p>
<pre class="language-swift" tabindex="0"><code class="language-swift">scrollViewValue<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span>progression<span class="token punctuation">)</span></code></pre>
<p>There's also a useful trick of making use of <a href="https://developer.apple.com/documentation/swiftui/view/onpreferencechange(_:perform:)">onPreferenceChange</a> and a <code>ViewOffsetKey</code> change. This <a href="https://stackoverflow.com/a/62588295">StackOverflow answer</a> gives more details.</p>
<p>This allows me to do handy stuff like adjusting the offset of the animation when scrolling, or highlight the currently active step in the set of circles along the bottom of the screen.</p>
<div class="video-wrapper">
    <video autoplay muted loop playsinline width="300">
    <source src="https://i.imgur.com/jeCpxED.mp4" type="video/mp4">
    </video>
</video>
<p>One detail to note: I'm not displaying an animation on each of the scrolling items. I found that was heavy to try to display up to 10 side by side, so instead I have one animation and I update the animation name based on scroll position when the animation is hidden with opacity.</p>
<h3 id="saving-to-the-journal" tabindex="-1">Saving to the journal <a class="header-anchor" href="#saving-to-the-journal">#</a></h3>
<p>Using the stepper to select the number of reps updates the displayed number both in the text and the button. Pressing the button then calls a function that saves a journal entry. This is made up of date, exercise details and reps. For this I use <a href="https://developer.apple.com/documentation/swiftdata">SwiftData</a>. This is a fairly painless way to save the values and persist larger data sets than would be possible with <code>UserDefaults</code>.</p>
<h3 id="adding-exercises" tabindex="-1">Adding exercises <a class="header-anchor" href="#adding-exercises">#</a></h3>
<div style="max-width: 294.5px; padding-top: 20px">
<picture><source type="image/avif" srcset="/img/AxUJ_93ga4-1179.avif 1179w"><source type="image/webp" srcset="/img/AxUJ_93ga4-1179.webp 1179w"><img alt="Adding exercise." loading="lazy" decoding="async" src="/img/AxUJ_93ga4-1179.png" width="1179" height="2556"></picture>
</div>
<p>Selecting the <code>+</code> shows a <a href="https://developer.apple.com/documentation/swiftui/view/confirmationdialog(_:ispresented:titlevisibility:actions:)-46zbb">confirmation dialog</a> containing exercise types that aren't currently in the day's routine. To keep the structure of the app simple, I chose to allow one of each type of exercise per day. Users can log more sets if they wish, or adjust the level if it's too easy or hard.</p>
<h3 id="empty-state" tabindex="-1">Empty state <a class="header-anchor" href="#empty-state">#</a></h3>
<div style="max-width: 294.5px; padding-top: 20px">
<picture><source type="image/avif" srcset="/img/XuKE5Fu0aX-1179.avif 1179w"><source type="image/webp" srcset="/img/XuKE5Fu0aX-1179.webp 1179w"><img alt="Empty home view." loading="lazy" decoding="async" src="/img/XuKE5Fu0aX-1179.png" width="1179" height="2556"></picture>
</div>
<p>Empty states are an important part of any UI. I will need to add more to this screen but to make it nicer but it's good to have some kind of message to let the user know that the view isn't broken.</p>
<h3 id="edit-mode" tabindex="-1">Edit mode <a class="header-anchor" href="#edit-mode">#</a></h3>
<div style="max-width: 294.5px; padding-top: 20px">
<picture><source type="image/avif" srcset="/img/BJPF1LTeLz-1179.avif 1179w"><source type="image/webp" srcset="/img/BJPF1LTeLz-1179.webp 1179w"><img alt="Home view in edit mode." loading="lazy" decoding="async" src="/img/BJPF1LTeLz-1179.png" width="1179" height="2556"></picture>
</div>
<p>On the home view pressing <code>Edit</code> makes the list change to show delete and reordering UI. When in edit mode, I add in buttons to navigate between days. Selecting any of the exercises opens a <code>ProgressionViewer</code> view in a sheet but with the set of progressions being shown being the other stages of that exercise type.</p>
<h3 id="changing-progressions" tabindex="-1">Changing progressions <a class="header-anchor" href="#changing-progressions">#</a></h3>
<div style="max-width: 294.5px; padding-top: 20px">
<picture><source type="image/avif" srcset="/img/XRGfzPJY-W-1179.avif 1179w"><source type="image/webp" srcset="/img/XRGfzPJY-W-1179.webp 1179w"><img alt="Editing a progression." loading="lazy" decoding="async" src="/img/XRGfzPJY-W-1179.png" width="1179" height="2556"></picture>
</div>
<p>The left and right arrows move between levels and stages, and the stages can be scrolled through also. Then the chosen level saved, which updates the <code>UserExerciseStages</code> stored data.</p>
<p>This is then reflected across any instances of that exercise type through the rest of the week.</p>
<h2 id="step-4-styling" tabindex="-1">Step 4: Styling <a class="header-anchor" href="#step-4-styling">#</a></h2>
<p>This being my first app I'm working things out as I go in terms of how it looks. I'm aiming for it being simple, ideally a little fun, but bright and clear. This is something that will definitely evolve.</p>
<p>When styling the list items, I found <a href="https://www.youtube.com/watch?v=tjR1hLg4-wc">this Youtube video from Karin Prater</a> very helpful.</p>
<h3 id="colors-settings" tabindex="-1">Colors settings <a class="header-anchor" href="#colors-settings">#</a></h3>
<p>Rather than specify a lot of colours everywhere, I set up a <code>Colors.swift</code> file where I can extend <code>Color</code>:</p>
<pre class="language-swift" tabindex="0"><code class="language-swift"><span class="token keyword">extension</span> <span class="token class-name">Color</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">let</span> themeColor <span class="token operator">=</span> <span class="token class-name">Color</span><span class="token punctuation">(</span>red<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> green<span class="token punctuation">:</span> <span class="token number">0.4</span><span class="token punctuation">,</span> blue<span class="token punctuation">:</span> <span class="token number">0.2</span><span class="token punctuation">)</span>
    <span class="token keyword">static</span> <span class="token keyword">let</span> lightBg <span class="token operator">=</span> <span class="token class-name">Color</span><span class="token punctuation">(</span>red<span class="token punctuation">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span> green<span class="token punctuation">:</span> <span class="token number">0.9</span><span class="token punctuation">,</span> blue<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>gradient
    <span class="token keyword">static</span> <span class="token keyword">let</span> darkBg <span class="token operator">=</span> <span class="token class-name">Color</span><span class="token punctuation">(</span>red<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> green<span class="token punctuation">:</span> <span class="token number">0.05</span><span class="token punctuation">,</span> blue<span class="token punctuation">:</span> <span class="token number">0.15</span><span class="token punctuation">)</span><span class="token punctuation">.</span>gradient
    <span class="token keyword">static</span> <span class="token keyword">let</span> lightAnimationBg <span class="token operator">=</span> <span class="token class-name">Color</span><span class="token punctuation">.</span>white
    <span class="token keyword">static</span> <span class="token keyword">let</span> darkAnimationBg <span class="token operator">=</span> <span class="token class-name">Color</span><span class="token punctuation">.</span>white<span class="token punctuation">.</span><span class="token function">opacity</span><span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span>
    <span class="token keyword">static</span> <span class="token keyword">let</span> secondaryButtonBg <span class="token operator">=</span> themeColor<span class="token punctuation">.</span>gradient
<span class="token punctuation">}</span></code></pre>
<p>This will act as a central place for storing the theme. For version <code>0.1</code> I am ok with it but it definitely needs more polish.</p>
<h3 id="light-and-dark-mode" tabindex="-1">Light and dark mode <a class="header-anchor" href="#light-and-dark-mode">#</a></h3>
<div style="max-width: 600px; padding-top: 20px; display: flex; gap: 10px;">
<picture><source type="image/avif" srcset="/img/vfoy9oM4oo-1179.avif 1179w"><source type="image/webp" srcset="/img/vfoy9oM4oo-1179.webp 1179w"><img alt="Home view in dark mode." loading="lazy" decoding="async" src="/img/vfoy9oM4oo-1179.png" width="1179" height="2556"></picture>
<picture><source type="image/avif" srcset="/img/jZxis_J2Sh-1179.avif 1179w"><source type="image/webp" srcset="/img/jZxis_J2Sh-1179.webp 1179w"><img alt="Recording exercise view in dark mode." loading="lazy" decoding="async" src="/img/jZxis_J2Sh-1179.png" width="1179" height="2556"></picture>
</div>
<p>The <code>Color</code> values include light and dark. I'm not sure yet how well this will work but I'm swapping out these in the various backgrounds and foregroundStyles using <a href="https://developer.apple.com/documentation/swiftui/environmentvalues/colorscheme">@Environment(.colorScheme)</a>.</p>
<h2 id="next-steps" tabindex="-1">Next steps <a class="header-anchor" href="#next-steps">#</a></h2>
<p>This post reflects a lot of work over 6 months. There's lots more to do before I'll be able to set up a Testflight and start getting some user testing. Some things I'd like to have before then:</p>
<ul>
<li>Onboarding screen for helping build a starting routine</li>
<li>Icons, so many icons (one for each progression)</li>
<li>Set up primary and secondary button styles to tidy the code a bit</li>
<li>Add in an (initially empty) journal view to surface some useful stats or graphs</li>
<li>App icon, other small details</li>
</ul>
<p>I'll try to do a regular update here. By reading this you're providing me with much-needed accountability!</p>

<ul class="links-nextprev"><li>Previous: <a href="/app-roundup-1/">Launch Apps</a></li><li>Next: <a href="/returns/">Are people returning Vision Pro?</a></li>
</ul>
</div>

		</main>

		<footer class="panel padded">
			<div class="signup">
				<h2>Donovan's Vision Newsletter</h2>
				<p>Stay up to date when new posts land</p>
				<div class="signup-frame">
					<iframe
					src="https://embeds.beehiiv.com/e4b485a8-6ae4-48c8-a4aa-e699ebbc193f?slim=true"
					data-test-id="beehiiv-embed"
					height="52"
					width="100%"
					frameborder="0"
					scrolling="no"
					style="margin: 1rem 0 2rem; border-radius: 0px !important; background-color: transparent;"
					></iframe>
				</div>
			</div>
			<nav class="panel secondary">
					<h2 class="visually-hidden">Footer navigation menu</h2>
					<ul class="nav">
						<li class="nav-item"><a href="/">Home</a></li>
						<li class="nav-item"><a href="/blog/">All Posts</a></li>
						<li class="nav-item"><a href="/links/">Cool Links</a></li>
					</ul>
				</nav>
				<p>This website is built on <a href="http://eleventy-base-blog.netlify.app">Eleventy Base Blog</a> with a few small tweaks.</p>

			<p>Thanks for reading, be sure to check out <a href="/feed/feed.xml">the RSS feed</a>.</p>
				<p>All content @2024 <a href="https://hop.ie">Donovan Hutchinson</a></p>
		</footer>

		<!-- Current page: /dev-diary-01/ -->
	</body>
</html>
